---
title: "P8105 Data Science I Homework 2"
author: Olivia Wang (hw2852)
output: github_document
date: "2022-10-05"
---

# Problem 1 

## 1.1 Read, Clean, Select, Mutate Transit Data

We will first read and clean the CSV data set containing the NYC Transit data. To do so, we will first load in the `tidyverse` package that contains the necessary functions. We will also retain the following columns (i.e., variables) using the `select` function: 

* Line
* Station
* Name
* Station Latitude
* Station Longitude
* Routes Served
* Entry
* Vending
* Entrance Type
* ADA Compliance

```{r}
library(tidyverse)
transit_data = 
  read_csv("./NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names(.) %>% 
  select(., line, station_name, station_latitude, station_longitude, starts_with("route"), entry, vending, entrance_type, ada)
```

Next, we will convert the `entry` variable from a character (YES vs. NO) to a logical variable using the `ifelse` function. 
```{r}
transit_data = mutate(transit_data, entry = ifelse(entry == "YES", TRUE, FALSE))
```

Let us now generate a summary of the `transit_data` data set, and determine the number of rows and columns in this data set. 
```{r}
summary(transit_data)
nrow(transit_data)
ncol(transit_data)
```

The newly created `transit_data` data set contains __1868 rows__ and __19 columns__.So far, we have loaded in the CSV data set containing NYC Transit data. We then applied the `clean_names` function to clean up variable names. The `select` function was applied to retain the prescribed 19 variables. The `entry` variable was then converted from a character variable (YES vs. NO) to a logical variable (TRUE vs. FALSE). This tidied data set can now be used for further analysis. 


## 1.2 Analyzing Transit Data

### 1.2.1 Enumerating Distinct Stations

To determine the number of distinct stations, the `distinct` function can be applied. To do so, we must first load in the `dplyr` package that contains the function. 
```{r}
library(dplyr)
distinct(transit_data, line, station_name, .keep_all = TRUE)
```

Based on the output generated from the code above, we can conclude that there are __465__ distinct stations. 

### 1.2.2 Enumerating ADA-Compliant Stations

To determine the number of stations that are ADA compliant, we can apply the `count` function to, as the name suggests, count the number of entries for the `ada` variable are "TRUE". 

```{r}
count(transit_data, ada)
```

Based on the output generated from the code above, we can conclude that there are __468__ ADA-compliant stations. 

### 1.2.3 Proportion of Station Entrances & Exits Without Vending Allow Entry

To determine the proportion of station entrances and exits without vending that allow entry, we can create the following two variables: `no_vending_total`, representing the total number of station entrances and exits that do not have vending; and `no_vending_yes_entry`, representing the total number of station entrances and exits that do not have vending, but also allow entry. We can then divide the value of `no_vending_yes_entry` by that of `no_vending_total` to get a final proportion. 

```{r, include= TRUE}
no_vending_total = nrow(transit_data[transit_data$vending == 'NO', ])
no_vending_yes_entry = nrow(transit_data[which(transit_data$vending == 'NO' & transit_data$entry == TRUE), ])
no_vending_yes_entry / no_vending_total

```
Based on the output generated from the code above, we can conclude that about __37.7%__ of station entrances and exists without vending allow entry. 

### 1.2.4

# Problem 2

We will first read and clean the Mr. Trash Wheel Excel spreadsheet. 

```{r load_libraries}
library(readxl)
library(tidyverse)
```
```{r}
mr_trash_wheel = 
  read_excel("Trash Wheel Collection Data.xlsx", col_names = TRUE, sheet = 1, skip = 1) %>%
  janitor::clean_names(.) %>% 
  select(-x15, -x16) %>% 
  mutate(sports_balls = as.integer(sports_balls), trash_program = "mr trash wheel") %>% 
  filter(!is.na(dumpster))
```

Next, let us read and clean the Professor Trash Wheel Excel spreadsheet. 
```{r}
professor_trash_wheel = 
  read_excel("Trash Wheel Collection Data.xlsx", col_names = TRUE, sheet = 2, skip = 1) %>%
  janitor::clean_names(.) %>%
  mutate(year = as.character(year), trash_program = "professor trash wheel") %>% 
  filter(!is.na(dumpster))
```

We proceed to combine the Mr. Trash Wheel and Professor Trash Wheel datasets using `bind_rows`.

```{r}
tidy_trash_wheel = bind_rows(mr_trash_wheel, professor_trash_wheel)
```

```{r}
nrow(tidy_trash_wheel)
```
```{r}
sum(tidy_trash_wheel$weight_tons[tidy_trash_wheel$trash_program == "professor trash wheel"], na.rm = TRUE)
```

```{r}
sum(tidy_trash_wheel$sports_balls[tidy_trash_wheel$trash_program == "mr trash wheel" & tidy_trash_wheel$year == "2020"], na.rm = TRUE)
```

# Problem 3

First, we will read and clean the `pols-month.csv` file. 
```{r}
national_politicians = 
  read.csv("./pols-month.csv") %>% 
  janitor::clean_names(.) %>% 
  separate(col = mon, into = c('year', 'month','day'), sep = '-') %>%
  mutate(month = recode(month,
                        '01' = "January",
                        '02' = "February",
                        '03' = "March",
                        '04' = "April",
                        '05' = "May",
                        '06' = "June",
                        '07' = "July",
                        '08' = "August",
                        '09' = "September",
                        '10' = "October",
                        '11' = "November",
                        '12' = "December"), 
                president = ifelse(prez_gop == 1, "gop", "dem")) %>% 
  select(-prez_gop, -prez_dem, -day)

```

**Note sometimes prez+gop is equal to 2?

Next, we will read and clean the `snp.cvs` file. 
```{r}
snp_closing_value = 
  read.csv("./snp.csv") %>% 
  janitor::clean_names(.) %>%
  mutate(date = as.Date(date, "%m/%d/%y")) %>% 
  separate(col = date, into = c('year', 'month','day'), sep = '-') %>%
  mutate(month = recode(month,
                        '01' = "January",
                        '02' = "February",
                        '03' = "March",
                        '04' = "April",
                        '05' = "May",
                        '06' = "June",
                        '07' = "July",
                        '08' = "August",
                        '09' = "September",
                        '10' = "October",
                        '11' = "November",
                        '12' = "December")) %>%  
  select(-day)
```

